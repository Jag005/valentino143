<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Will You Be My Valentine? üíï</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            font-family: 'Poppins', sans-serif;
            background: #000;
            color: white;
            position: fixed;
            touch-action: none;
        }

        /* 3D Canvas */
        #three-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff1e56, #ff6b9d, #ffd1dc);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s, transform 1s;
        }

        #loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
            transform: scale(1.1);
        }

        .loading-heart {
            width: 120px;
            height: 120px;
            background: white;
            position: relative;
            transform: rotate(45deg);
            animation: heartbeat 1.2s ease-in-out infinite;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.5);
            margin-bottom: 30px;
        }

        .loading-heart:before,
        .loading-heart:after {
            content: '';
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
            position: absolute;
        }

        .loading-heart:before {
            top: -60px;
            left: 0;
        }

        .loading-heart:after {
            top: 0;
            left: -60px;
        }

        @keyframes heartbeat {
            0%, 100% { transform: rotate(45deg) scale(1); }
            25% { transform: rotate(45deg) scale(1.1); }
            50% { transform: rotate(45deg) scale(1); }
            75% { transform: rotate(45deg) scale(1.05); }
        }

        .loading-text {
            font-family: 'Pacifico', cursive;
            font-size: 2.5em;
            color: white;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            margin-top: 20px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Welcome Animation */
        #welcome-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #0a0e27 0%, #000 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999;
            opacity: 1;
            transition: opacity 1.5s;
        }

        #welcome-animation.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .welcome-title {
            font-family: 'Pacifico', cursive;
            font-size: 4em;
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ff6b9d, #ffd1dc, #ff6b9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: gradient 3s ease infinite;
        }

        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .welcome-subtitle {
            font-size: 1.5em;
            text-align: center;
            color: #ffd1dc;
            margin-bottom: 50px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.5s forwards;
        }

        .start-button {
            padding: 20px 60px;
            font-size: 1.8em;
            background: linear-gradient(45deg, #ff6b9d, #ff1744);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Pacifico', cursive;
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.5);
            transition: all 0.3s;
            opacity: 0;
            animation: fadeInUp 1s ease 1s forwards;
            transform: translateY(20px);
        }

        .start-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(255, 107, 157, 0.7);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Main Content */
        .page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 10;
            pointer-events: none;
        }

        .page.active {
            display: flex;
            pointer-events: all;
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 0 0 1px rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 600px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .container::-webkit-scrollbar {
            width: 5px;
        }

        .container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .container::-webkit-scrollbar-thumb {
            background: rgba(255, 107, 157, 0.5);
            border-radius: 10px;
        }

        h1 {
            font-family: 'Pacifico', cursive;
            font-size: clamp(2.2em, 5vw, 3.5em);
            margin-bottom: 30px;
            color: #ff6b9d;
            text-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
            line-height: 1.2;
        }

        .quote {
            font-size: clamp(1em, 3vw, 1.3em);
            font-style: italic;
            margin: 25px 0;
            line-height: 1.6;
            color: #ffd1dc;
            text-shadow: 0 2px 10px rgba(255, 209, 220, 0.3);
        }

        input {
            padding: 15px 25px;
            font-size: 1.1em;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            margin: 12px 0;
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            font-family: 'Poppins', sans-serif;
        }

        input:focus {
            outline: none;
            border-color: #ff6b9d;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 25px rgba(255, 107, 157, 0.3);
            transform: translateY(-2px);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        button {
            padding: 16px 40px;
            font-size: 1.3em;
            background: linear-gradient(135deg, #ff6b9d 0%, #ff1744 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            margin: 15px 10px;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            letter-spacing: 1px;
            box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
            position: relative;
            overflow: hidden;
            min-width: 150px;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.7s;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 35px rgba(255, 107, 157, 0.7);
        }

        button:active {
            transform: translateY(-2px) scale(1.02);
        }

        /* Timeline Page */
        .timeline {
            position: relative;
            max-width: 500px;
            margin: 30px auto;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin: 25px 0;
            opacity: 0;
            transform: translateX(-30px);
            animation: slideIn 0.8s ease forwards;
        }

        .timeline-item:nth-child(1) { animation-delay: 0.2s; }
        .timeline-item:nth-child(2) { animation-delay: 0.4s; }
        .timeline-item:nth-child(3) { animation-delay: 0.6s; }
        .timeline-item:nth-child(4) { animation-delay: 0.8s; }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .timeline-icon {
            font-size: 2.5em;
            margin-right: 20px;
            filter: drop-shadow(0 0 15px rgba(255, 107, 157, 0.7));
            min-width: 60px;
        }

        .timeline-content {
            text-align: left;
            flex: 1;
        }

        .timeline-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #ff6b9d;
            margin-bottom: 5px;
        }

        .timeline-text {
            color: #ffd1dc;
            font-size: 1em;
            line-height: 1.5;
        }

        /* Love Cards */
        .love-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 30px 0;
            max-width: 600px;
        }

        .love-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 107, 157, 0.3);
            border-radius: 20px;
            padding: 25px 15px;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform-style: preserve-3d;
            position: relative;
            min-height: 140px;
            perspective: 1000px;
        }

        .love-card:hover {
            transform: rotateY(180deg);
            box-shadow: 0 15px 35px rgba(255, 107, 157, 0.4);
        }

        .card-front, .card-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            border-radius: 20px;
        }

        .card-front {
            font-size: 2.5em;
            background: rgba(255, 107, 157, 0.1);
        }

        .card-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.2), rgba(255, 192, 203, 0.2));
            font-size: 1.1em;
            line-height: 1.6;
            text-align: center;
        }

        /* Teddy Bear Container */
        #teddy-container {
            width: 280px;
            height: 280px;
            margin: 25px auto;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .teddy-bear-2d {
            width: 200px;
            height: 200px;
            position: relative;
            animation: float 4s ease-in-out infinite;
            transition: all 0.3s;
            transform-origin: center bottom;
        }

        .teddy-bear-2d.nervous {
            animation: nervous 0.8s ease-in-out infinite;
        }

        @keyframes nervous {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .teddy-bear-2d.jealous {
            animation: jealous 1.2s ease-in-out infinite;
        }

        @keyframes jealous {
            0%, 100% { transform: rotate(0deg); }
            33% { transform: rotate(-8deg); }
            66% { transform: rotate(8deg); }
        }

        .teddy-bear-2d.shy {
            animation: shy 2s ease-in-out infinite;
        }

        @keyframes shy {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.95); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        /* Enhanced Teddy Bear */
        .teddy-body {
            position: absolute;
            width: 140px;
            height: 160px;
            background: linear-gradient(
                145deg,
                #FFB6C1 0%,
                #FFC0CB 25%,
                #FFD1DC 50%,
                #FFC0CB 75%,
                #FFB6C1 100%
            );
            border-radius: 70px 70px 55px 55px / 80px 80px 55px 55px;
            top: 65px;
            left: 40px;
            box-shadow: 
                inset -8px -8px 20px rgba(0, 0, 0, 0.15),
                inset 8px 8px 20px rgba(255, 255, 255, 0.4),
                0 8px 25px rgba(255, 107, 157, 0.3);
            border: 3px solid #FF8FA3;
            animation: breathe 3.5s ease-in-out infinite;
            filter: drop-shadow(0 4px 8px rgba(255, 107, 157, 0.2));
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        .teddy-head {
            position: absolute;
            width: 110px;
            height: 110px;
            background: linear-gradient(
                145deg,
                #FFB6C1 0%,
                #FFC0CB 40%,
                #FFE4E1 70%,
                #FFC0CB 100%
            );
            border-radius: 50%;
            top: 15px;
            left: 50px;
            box-shadow: 
                inset -5px -5px 15px rgba(0, 0, 0, 0.15),
                inset 5px 5px 15px rgba(255, 255, 255, 0.4),
                0 5px 20px rgba(255, 107, 157, 0.3);
            border: 3px solid #FF8FA3;
            z-index: 2;
        }

        .teddy-ear {
            position: absolute;
            width: 45px;
            height: 45px;
            background: radial-gradient(ellipse at 30% 30%, #FFB6C1, #FF8FA3);
            border-radius: 50%;
            top: -5px;
            box-shadow: 
                inset -3px -3px 8px rgba(0, 0, 0, 0.15),
                inset 3px 3px 8px rgba(255, 255, 255, 0.3),
                0 3px 10px rgba(255, 107, 157, 0.3);
            border: 3px solid #FF8FA3;
            z-index: 1;
            animation: earWiggle 4s ease-in-out infinite;
        }

        @keyframes earWiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        .teddy-ear.left { 
            left: 10px;
            animation-delay: 0.5s;
        }
        
        .teddy-ear.right { 
            right: 10px;
        }

        .ear-inner {
            position: absolute;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle at 30% 30%, #FF6B9D, #FF8FA3);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: inset 3px 3px 6px rgba(255, 255, 255, 0.4);
        }

        .teddy-eye {
            position: absolute;
            width: 24px;
            height: 28px;
            background: radial-gradient(ellipse at 40% 40%, #ffffff, #f0f0f0);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            top: 40px;
            overflow: hidden;
            border: 2px solid #FF8FA3;
            box-shadow: 
                0 3px 8px rgba(0, 0, 0, 0.2),
                inset 0 3px 8px rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .teddy-eye.left { left: 28px; }
        .teddy-eye.right { right: 28px; }

        .teddy-eye.narrow {
            height: 15px;
            top: 45px;
        }

        .eye-pupil {
            position: absolute;
            width: 14px;
            height: 14px;
            background: radial-gradient(circle at 30% 30%, #5A2D5A, #4A235A);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: transform 0.2s ease;
        }

        .eye-sparkle {
            position: absolute;
            width: 5px;
            height: 5px;
            background: white;
            border-radius: 50%;
            top: 6px;
            left: 6px;
            animation: sparkle 2s infinite;
            box-shadow: 0 0 8px white;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(0.8); }
        }

        .eye-lashes {
            position: absolute;
            width: 100%;
            height: 12px;
            top: -10px;
            display: flex;
            justify-content: space-around;
            padding: 0 2px;
        }

        .lash {
            width: 2px;
            height: 10px;
            background: linear-gradient(to bottom, #4A235A, transparent);
            border-radius: 2px;
        }

        .lash:nth-child(1) { transform: rotate(-15deg); }
        .lash:nth-child(2) { transform: rotate(0deg); }
        .lash:nth-child(3) { transform: rotate(15deg); }

        .teddy-nose {
            position: absolute;
            width: 24px;
            height: 18px;
            background: radial-gradient(ellipse at 40% 40%, #FF6B9D, #FF5588);
            border-radius: 50% 50% 45% 45%;
            top: 65px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            z-index: 3;
        }

        .nose-highlight {
            position: absolute;
            width: 8px;
            height: 4px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            top: 4px;
            left: 50%;
            transform: translateX(-50%);
        }

        .teddy-mouth {
            position: absolute;
            width: 40px;
            height: 20px;
            top: 83px;
            left: 50%;
            transform: translateX(-50%);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 2;
        }

        .mouth-neutral {
            width: 18px;
            height: 10px;
            border: 3px solid #4A235A;
            border-top: none;
            border-radius: 0 0 25px 25px;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .mouth-happy {
            width: 40px;
            height: 28px;
            border: 3px solid #4A235A;
            border-top: none;
            border-radius: 0 0 40px 40px;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 2px 0 rgba(255, 107, 157, 0.3);
        }

        .mouth-sad {
            width: 28px;
            height: 18px;
            border: 3px solid #4A235A;
            border-bottom: none;
            border-radius: 25px 25px 0 0;
            position: absolute;
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
        }

        .mouth-o {
            width: 20px;
            height: 20px;
            border: 3px solid #4A235A;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .teddy-arm {
            position: absolute;
            width: 55px;
            height: 75px;
            background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
            border-radius: 50%;
            top: 110px;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 
                inset -4px -4px 10px rgba(0, 0, 0, 0.15),
                inset 4px 4px 10px rgba(255, 255, 255, 0.3),
                0 4px 12px rgba(255, 107, 157, 0.3);
            border: 3px solid #FF8FA3;
            z-index: 1;
        }

        .teddy-arm.left {
            left: 25px;
            transform: rotate(-30deg);
        }

        .teddy-arm.right {
            right: 25px;
            transform: rotate(30deg);
        }

        .arm-paw {
            position: absolute;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
            border-radius: 50%;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            border: 2px solid #FF8FA3;
            box-shadow: inset 2px 2px 5px rgba(255, 255, 255, 0.3);
        }

        .paw-toe {
            position: absolute;
            width: 9px;
            height: 9px;
            background: radial-gradient(circle, #FF6B9D, #FF8FA3);
            border-radius: 50%;
        }

        .paw-toe:nth-child(1) { top: 6px; left: 6px; }
        .paw-toe:nth-child(2) { top: 6px; right: 6px; }
        .paw-toe:nth-child(3) { bottom: 6px; left: 12px; }

        .teddy-leg {
            position: absolute;
            width: 55px;
            height: 65px;
            background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
            border-radius: 50% 50% 45% 45%;
            bottom: 25px;
            box-shadow: 
                inset -4px -4px 10px rgba(0, 0, 0, 0.15),
                inset 4px 4px 10px rgba(255, 255, 255, 0.3),
                0 4px 12px rgba(255, 107, 157, 0.3);
            border: 3px solid #FF8FA3;
        }

        .teddy-leg.left { left: 50px; }
        .teddy-leg.right { right: 50px; }

        .leg-pad {
            position: absolute;
            width: 40px;
            height: 28px;
            background: radial-gradient(ellipse, #FF6B9D, #FF8FA3);
            border-radius: 50%;
            bottom: 6px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: inset 3px 3px 6px rgba(255, 255, 255, 0.4);
        }

        .teddy-heart {
            position: absolute;
            width: 70px;
            height: 70px;
            top: 60px;
            left: 50%;
            transform: translateX(-50%) scale(0);
            transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            filter: drop-shadow(0 8px 20px rgba(255, 107, 157, 0.9));
            z-index: 3;
        }

        .teddy-heart.show {
            transform: translateX(-50%) scale(1);
        }

        .teddy-heart svg {
            width: 100%;
            height: 100%;
            animation: heartbeat 1.2s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.15); }
            50% { transform: scale(1); }
            75% { transform: scale(1.08); }
        }

        .cheek-blush {
            position: absolute;
            width: 24px;
            height: 14px;
            background: radial-gradient(ellipse, rgba(255, 107, 157, 0.4), transparent);
            border-radius: 50%;
            top: 65px;
            filter: blur(4px);
            transition: all 0.3s;
        }

        .cheek-blush.left { left: 18px; }
        .cheek-blush.right { right: 18px; }

        .cheek-blush.active {
            background: radial-gradient(ellipse, rgba(255, 107, 157, 0.7), transparent);
            width: 28px;
            height: 18px;
        }

        /* Sweaty Forehead */
        .sweat-drop {
            position: absolute;
            width: 8px;
            height: 12px;
            background: rgba(135, 206, 250, 0.7);
            border-radius: 50% 50% 50% 0;
            top: 15px;
            right: 30px;
            z-index: 4;
            opacity: 0;
            animation: sweatDrop 2s ease-in-out infinite;
        }

        .teddy-bear-2d.nervous .sweat-drop {
            opacity: 1;
        }

        @keyframes sweatDrop {
            0% { transform: translateY(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(20px); opacity: 0; }
        }

        /* Paw covers */
        .paw-cover {
            position: absolute;
            width: 55px;
            height: 60px;
            background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
            border-radius: 50%;
            border: 3px solid #FF8FA3;
            z-index: 10;
            opacity: 0;
            transition: all 0.5s;
        }

        .paw-cover.left {
            left: 20px;
            top: 80px;
            transform: rotate(-20deg);
        }

        .paw-cover.right {
            right: 20px;
            top: 80px;
            transform: rotate(20deg);
        }

        .teddy-bear-2d.shy .paw-cover {
            opacity: 1;
        }

        /* Heartbeat indicator */
        .heartbeat-indicator {
            position: absolute;
            font-size: 20px;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 4;
            opacity: 0;
        }

        .teddy-bear-2d.nervous .heartbeat-indicator {
            opacity: 1;
            animation: heartbeatPulse 0.8s ease-in-out infinite;
        }

        @keyframes heartbeatPulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.3); }
        }

        /* Question Box */
        .question-box {
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.15), rgba(255, 192, 203, 0.15));
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            padding: 30px 25px;
            border-radius: 20px;
            margin: 20px auto;
            border: 2px solid rgba(255, 107, 157, 0.3);
            box-shadow: 
                0 8px 32px rgba(255, 107, 157, 0.3),
                inset 0 0 0 1px rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            max-width: 90%;
        }

        .question {
            font-size: clamp(1.5em, 4.5vw, 2.2em);
            line-height: 1.4;
            font-family: 'Pacifico', cursive;
            background: linear-gradient(45deg, #ff6b9d, #ffd1dc, #ff6b9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            word-wrap: break-word;
            hyphens: auto;
            padding: 0 10px;
        }

        .typing-text {
            display: inline-block;
            overflow: hidden;
            white-space: normal;
            word-wrap: break-word;
            border-right: 3px solid #ff6b9d;
            animation: typing 3s steps(60, end) 1s forwards, blink 0.7s step-end infinite;
            max-width: 100%;
        }

        @keyframes typing {
            from { max-width: 0; }
            to { max-width: 100%; }
        }

        @keyframes blink {
            50% { border-color: transparent; }
        }

        /* Button Container */
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 25px;
        }

        #noBtn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.2s;
            position: relative;
            z-index: 20;
        }

        /* Game Canvas */
        #game-canvas {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            display: block;
            margin: 15px auto;
            border: 2px solid rgba(255, 255, 255, 0.1);
            cursor: none;
            touch-action: none;
            max-width: 95%;
        }

        .game-info {
            font-size: 1.2em;
            margin: 15px 0;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 500px;
            margin: 15px auto;
        }

        .game-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            min-width: 100px;
            text-align: center;
        }

        /* Final Page */
        .final-message {
            font-size: clamp(2em, 6vw, 3.5em);
            animation: pulse 2s ease-in-out infinite;
            font-family: 'Pacifico', cursive;
            color: #ff6b9d;
            text-shadow: 0 0 30px rgba(255, 107, 157, 0.8);
            margin: 20px 0;
            line-height: 1.2;
            text-align: center;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .percentage {
            font-size: clamp(2em, 5vw, 3em);
            margin: 25px 0;
            color: #ffff00;
            text-shadow: 0 0 20px rgba(255, 255, 0, 0.5);
            font-weight: bold;
        }

        .love-certificate {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 107, 157, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin: 25px auto;
            max-width: 500px;
        }

        .certificate-header {
            font-size: 1.8em;
            font-family: 'Pacifico', cursive;
            margin-bottom: 20px;
            color: #ff6b9d;
            text-align: center;
        }

        .certificate-content {
            margin: 15px 0;
            line-height: 1.6;
            font-size: 1.1em;
        }

        .certificate-signature {
            margin-top: 25px;
            font-style: italic;
            font-size: 1.2em;
            text-align: right;
            color: #ffd1dc;
        }

        .share-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 12px 30px;
            font-size: 1em;
        }

        /* Music Control Button */
        .music-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b9d 0%, #ff1744 100%);
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(255, 107, 157, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: voicePulse 2s ease-in-out infinite;
            font-size: 1.5em;
            transition: all 0.3s;
        }

        @keyframes voicePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 4px 20px rgba(255, 107, 157, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 6px 30px rgba(255, 107, 157, 0.8); }
        }

        .music-btn:hover {
            transform: scale(1.1);
        }

        /* Cursor */
        .custom-cursor {
            position: fixed;
            width: 32px;
            height: 32px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Cpath fill='%23ff6b9d' d='M16 3C8.832 3 3 8.832 3 16s5.832 13 13 13 13-5.832 13-13S23.168 3 16 3zm0 2c6.086 0 11 4.914 11 11s-4.914 11-11 11S5 22.086 5 16 9.914 5 16 5z'/%3E%3Cpath fill='%23ff6b9d' d='M16 8c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zm0 2c3.308 0 6 2.692 6 6s-2.692 6-6 6-6-2.692-6-6 2.692-6 6-6z'/%3E%3C/svg%3E") center/contain no-repeat;
            pointer-events: none;
            z-index: 9999;
            transition: transform 0.1s;
            filter: drop-shadow(0 0 5px rgba(255, 107, 157, 0.5));
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { 
                padding: 30px 20px; 
                max-height: 85vh;
            }
            
            #teddy-container { 
                width: 250px; 
                height: 250px;
            }
            
            .teddy-bear-2d { 
                transform: scale(0.9);
            }
            
            .love-cards {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .question-box {
                padding: 20px 15px;
            }
            
            .timeline-item {
                margin: 20px 0;
            }
            
            .timeline-icon {
                font-size: 2em;
                min-width: 50px;
            }
            
            .music-btn {
                width: 50px;
                height: 50px;
                bottom: 15px;
                right: 15px;
            }
            
            .welcome-title {
                font-size: 2.8em;
            }
            
            .start-button {
                padding: 15px 40px;
                font-size: 1.5em;
            }
        }

        @media (max-width: 480px) {
            .container { 
                padding: 25px 15px;
                max-height: 80vh;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 250px;
                margin: 10px 0;
            }
            
            .game-stat {
                min-width: 80px;
                padding: 8px 15px;
                font-size: 0.9em;
            }
            
            #game-canvas {
                width: 95vw;
                height: 400px;
            }
            
            .love-certificate {
                padding: 20px 15px;
            }
            
            .final-message {
                font-size: 2em;
            }
            
            .percentage {
                font-size: 2.2em;
            }
            
            .welcome-title {
                font-size: 2.2em;
            }
            
            .welcome-subtitle {
                font-size: 1.2em;
            }
            
            .start-button {
                padding: 12px 30px;
                font-size: 1.2em;
            }
        }

        /* Tablet */
        @media (min-width: 769px) and (max-width: 1024px) {
            .container {
                max-width: 700px;
                padding: 50px 40px;
            }
            
            .love-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            #game-canvas {
                width: 600px;
                height: 500px;
            }
        }

        /* Desktop */
        @media (min-width: 1025px) {
            .container {
                max-width: 700px;
            }
            
            #game-canvas {
                width: 600px;
                height: 500px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-heart"></div>
        <div class="loading-text">Loading Love...</div>
    </div>

    <!-- Welcome Animation -->
    <div id="welcome-animation">
        <h1 class="welcome-title">Will You Be My Valentine? üíï</h1>
        <p class="welcome-subtitle">A magical journey of love awaits...</p>
        <button class="start-button" onclick="startExperience()">Begin Journey üíñ</button>
    </div>

    <!-- 3D Background -->
    <div id="three-container"></div>

    <!-- Pages -->
    <div class="page active" id="page1">
        <div class="container">
            <h1>üíï Valentine's Day üíï</h1>
            <div class="quote">"Love is composed of a single soul inhabiting two bodies." - Aristotle</div>
            <input type="text" id="boyName" placeholder="Boy's Name üíô" maxlength="20">
            <input type="text" id="girlName" placeholder="Girl's Name üíñ" maxlength="20">
            <button onclick="startJourney()">Continue ‚ûú</button>
        </div>
    </div>

    <div class="page" id="page2">
        <div class="container">
            <h1>How It Started üí´</h1>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-icon">üí´</div>
                    <div class="timeline-content">
                        <div class="timeline-title">First Meet</div>
                        <div class="timeline-text">When our eyes first met, my world changed forever...</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-icon">üí¨</div>
                    <div class="timeline-content">
                        <div class="timeline-title">First Conversation</div>
                        <div class="timeline-text">Your voice made my heart skip a beat...</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-icon">üòä</div>
                    <div class="timeline-content">
                        <div class="timeline-title">First Smile</div>
                        <div class="timeline-text">That smile that lights up my world...</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-icon">‚ù§Ô∏è</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Today</div>
                        <div class="timeline-text">Will you make me the happiest person?</div>
                    </div>
                </div>
            </div>
            <button onclick="showPage('page3')">Continue ‚ûú</button>
        </div>
    </div>

    <div class="page" id="page3">
        <div class="container">
            <h1>Why I Love You üíï</h1>
            <div class="love-cards">
                <div class="love-card">
                    <div class="card-front">üòä</div>
                    <div class="card-back">Your smile brightens even my darkest days</div>
                </div>
                <div class="love-card">
                    <div class="card-front">üò§</div>
                    <div class="card-back">Even your anger is adorable to me</div>
                </div>
                <div class="love-card">
                    <div class="card-front">ü§´</div>
                    <div class="card-back">Your peaceful silence speaks volumes</div>
                </div>
                <div class="love-card">
                    <div class="card-front">üíñ</div>
                    <div class="card-back">Everything about you is perfect to me</div>
                </div>
            </div>
            <button onclick="showPage('page4')">Continue ‚ûú</button>
        </div>
    </div>

    <div class="page" id="page4">
        <div class="container">
            <div class="question-box">
                <div class="question">
                    <span class="typing-text" id="question"></span>
                </div>
            </div>
            <div id="teddy-container">
                <div class="teddy-bear-2d nervous" id="teddyBear2D">
                    <div class="sweat-drop"></div>
                    <div class="heartbeat-indicator">üíì</div>
                    <div class="paw-cover left"></div>
                    <div class="paw-cover right"></div>
                    <div class="cheek-blush left" id="leftCheek"></div>
                    <div class="cheek-blush right" id="rightCheek"></div>
                    <div class="teddy-heart" id="teddyHeart">
                        <svg viewBox="0 0 100 100">
                            <path d="M50,90 C50,90 10,60 10,35 C10,20 20,10 32.5,10 C40,10 45,15 50,25 C55,15 60,10 67.5,10 C80,10 90,20 90,35 C90,60 50,90 50,90 Z" fill="#ff1744"/>
                        </svg>
                    </div>
                    <div class="teddy-head">
                        <div class="teddy-ear left">
                            <div class="ear-inner"></div>
                        </div>
                        <div class="teddy-ear right">
                            <div class="ear-inner"></div>
                        </div>
                        <div class="teddy-eye left" id="leftEye">
                            <div class="eye-lashes">
                                <div class="lash"></div>
                                <div class="lash"></div>
                                <div class="lash"></div>
                            </div>
                            <div class="eye-pupil"></div>
                            <div class="eye-sparkle"></div>
                        </div>
                        <div class="teddy-eye right" id="rightEye">
                            <div class="eye-lashes">
                                <div class="lash"></div>
                                <div class="lash"></div>
                                <div class="lash"></div>
                            </div>
                            <div class="eye-pupil"></div>
                            <div class="eye-sparkle"></div>
                        </div>
                        <div class="teddy-nose">
                            <div class="nose-highlight"></div>
                        </div>
                        <div class="teddy-mouth" id="teddyMouth">
                            <div class="mouth-neutral" id="mouthElement"></div>
                        </div>
                    </div>
                    <div class="teddy-body"></div>
                    <div class="teddy-arm left" id="leftArm">
                        <div class="arm-paw">
                            <div class="paw-toe"></div>
                            <div class="paw-toe"></div>
                            <div class="paw-toe"></div>
                        </div>
                    </div>
                    <div class="teddy-arm right" id="rightArm">
                        <div class="arm-paw">
                            <div class="paw-toe"></div>
                            <div class="paw-toe"></div>
                            <div class="paw-toe"></div>
                        </div>
                    </div>
                    <div class="teddy-leg left">
                        <div class="leg-pad"></div>
                    </div>
                    <div class="teddy-leg right">
                        <div class="leg-pad"></div>
                    </div>
                </div>
            </div>
            <div class="buttons">
                <button id="yesBtn" onclick="acceptProposal()">Yes! üíñ</button>
                <button id="noBtn">No üò¢</button>
            </div>
        </div>
    </div>

    <div class="page" id="page5">
        <div class="container">
            <h1>Catch My Hearts! üíï</h1>
            <div class="game-info">
                <div class="game-stat">‚è±Ô∏è <span id="timer">30</span>s</div>
                <div class="game-stat">üíï <span id="score">0</span></div>
                <div class="game-stat">üî• <span id="combo">0</span></div>
            </div>
            <canvas id="game-canvas" width="500" height="600"></canvas>
        </div>
    </div>

    <div class="page" id="page6">
        <div class="container">
            <div class="percentage" id="lovePercentage"></div>
            <div class="final-message">I LOVE YOU FOREVER üíñ</div>
            <div class="love-certificate">
                <div class="certificate-header">üíï Love Certificate üíï</div>
                <div class="certificate-content">
                    This certifies that on <strong id="certDate"></strong>,
                    <strong id="certGirl"></strong> captured <strong id="certScore"></strong> hearts,
                    proving a love percentage of <strong id="certPercent"></strong>%.
                </div>
                <div class="certificate-content">
                    Promise: <em id="certPromise">"I promise to love you forever and always."</em>
                </div>
                <div class="certificate-signature">- <span id="certBoy"></span> üíñ</div>
                <div class="share-buttons">
                    <button class="share-btn" onclick="shareCertificate()">üì§ Share</button>
                </div>
            </div>
        </div>
    </div>

    <button class="music-btn" id="musicBtn" onclick="toggleMusic()">üéµ</button>

    <!-- Custom Cursor -->
    <div class="custom-cursor"></div>

    <!-- Audio Elements -->
    <audio id="bgMusic1" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-tech-house-vibes-130.mp3" type="audio/mpeg">
    </audio>
    <audio id="bgMusic2" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-loving-you-117.mp3" type="audio/mpeg">
    </audio>
    <audio id="bgMusic3" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-a-very-happy-christmas-897.mp3" type="audio/mpeg">
    </audio>
    <audio id="bgMusic4" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-valentine-hearts-1185.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Global Variables
        let boyName = '';
        let girlName = '';
        let gameScore = 0;
        let comboCount = 0;
        let lastCatchTime = 0;
        let isMusicPlaying = false;
        let currentMusic = null;
        let scene, camera, renderer, controls;
        let hearts3D = [];
        let particles = [];
        let welcomeAnimationComplete = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Show loading screen
            setTimeout(() => {
                document.getElementById('loading-screen').classList.add('hidden');
                
                // Initialize 3D background
                initThreeJS();
                
                // Show welcome animation after short delay
                setTimeout(() => {
                    document.getElementById('welcome-animation').classList.remove('hidden');
                    welcomeAnimationComplete = true;
                }, 500);
                
                // Setup custom cursor
                setupCustomCursor();
            }, 2000);

            // Setup music
            const musics = [
                document.getElementById('bgMusic1'),
                document.getElementById('bgMusic2'),
                document.getElementById('bgMusic3'),
                document.getElementById('bgMusic4')
            ];
            
            musics.forEach(music => {
                music.volume = 0.3;
            });
        });

        // Custom Cursor
        function setupCustomCursor() {
            const cursor = document.querySelector('.custom-cursor');
            
            document.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            });
            
            document.addEventListener('mousedown', () => {
                cursor.style.transform = 'scale(0.8)';
            });
            
            document.addEventListener('mouseup', () => {
                cursor.style.transform = 'scale(1)';
            });
            
            // Hide cursor on touch devices
            if ('ontouchstart' in window) {
                cursor.style.display = 'none';
            }
        }

        // 3D Background with Three.js
        function initThreeJS() {
            // Scene
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x0a0e27, 10, 50);

            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 20;

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.getElementById('three-container').appendChild(renderer.domElement);

            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableZoom = false;
            controls.enablePan = false;
            controls.autoRotate = true;
            controls.autoRotateSpeed = 0.5;

            // Lights
            const ambientLight = new THREE.AmbientLight(0xff6b9d, 0.3);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0xffd1dc, 1, 100);
            pointLight.position.set(10, 10, 10);
            scene.add(pointLight);

            // Create floating hearts
            create3DHearts();

            // Create particles
            createParticles();

            // Handle window resize
            window.addEventListener('resize', onWindowResize);

            // Animation loop
            animate();
        }

        function create3DHearts() {
            const heartGeometry = new THREE.SphereGeometry(0.3, 8, 8);
            const heartMaterial = new THREE.MeshPhongMaterial({
                color: 0xff6b9d,
                emissive: 0xff6b9d,
                emissiveIntensity: 0.3,
                shininess: 100
            });

            for (let i = 0; i < 30; i++) {
                const heart = new THREE.Mesh(heartGeometry, heartMaterial);
                
                // Random position
                heart.position.x = (Math.random() - 0.5) * 40;
                heart.position.y = (Math.random() - 0.5) * 40;
                heart.position.z = (Math.random() - 0.5) * 40;
                
                // Random scale
                const scale = Math.random() * 0.5 + 0.3;
                heart.scale.set(scale, scale, scale);
                
                // Store animation properties
                heart.userData = {
                    speed: Math.random() * 0.02 + 0.01,
                    rotationSpeed: Math.random() * 0.02 + 0.01,
                    amplitude: Math.random() * 0.5 + 0.2,
                    timeOffset: Math.random() * Math.PI * 2
                };
                
                scene.add(heart);
                hearts3D.push(heart);
            }
        }

        function createParticles() {
            const particleGeometry = new THREE.BufferGeometry();
            const particleCount = 1000;
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);

            for (let i = 0; i < particleCount; i++) {
                // Position
                positions[i * 3] = (Math.random() - 0.5) * 100;
                positions[i * 3 + 1] = (Math.random() - 0.5) * 100;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 100;

                // Color
                const color = new THREE.Color();
                color.setHSL(Math.random() * 0.1 + 0.9, 0.8, 0.6);
                colors[i * 3] = color.r;
                colors[i * 3 + 1] = color.g;
                colors[i * 3 + 2] = color.b;
            }

            particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particleGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            const particleMaterial = new THREE.PointsMaterial({
                size: 0.1,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });

            const particleSystem = new THREE.Points(particleGeometry, particleMaterial);
            scene.add(particleSystem);
            particles.push(particleSystem);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            // Animate hearts
            const time = Date.now() * 0.001;
            
            hearts3D.forEach(heart => {
                // Float up and down
                heart.position.y += Math.sin(time + heart.userData.timeOffset) * 0.01 * heart.userData.amplitude;
                
                // Rotate
                heart.rotation.x += heart.userData.rotationSpeed;
                heart.rotation.y += heart.userData.rotationSpeed;
                
                // Breathe effect
                const scale = 0.3 + Math.sin(time + heart.userData.timeOffset) * 0.1;
                heart.scale.set(scale, scale, scale);
            });

            // Animate particles
            particles.forEach(particleSystem => {
                particleSystem.rotation.y += 0.001;
            });

            controls.update();
            renderer.render(scene, camera);
        }

        // Start Experience
        function startExperience() {
            if (!welcomeAnimationComplete) return;
            
            document.getElementById('welcome-animation').classList.add('hidden');
            
            // Create heart explosion animation
            createHeartExplosion();
            
            // Show page 1 after animation
            setTimeout(() => {
                document.getElementById('page1').classList.add('active');
                playMusic(1);
            }, 1000);
        }

        function createHeartExplosion() {
            const heartEmojis = ['üíï', 'üíñ', 'üíó', 'üíì', 'üíù', '‚ù§Ô∏è', 'üíò'];
            
            for (let i = 0; i < 50; i++) {
                const heart = document.createElement('div');
                heart.style.position = 'fixed';
                heart.style.fontSize = Math.random() * 30 + 20 + 'px';
                heart.style.left = '50%';
                heart.style.top = '50%';
                heart.style.transform = 'translate(-50%, -50%)';
                heart.style.opacity = '1';
                heart.style.zIndex = '999';
                heart.style.pointerEvents = 'none';
                heart.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
                document.body.appendChild(heart);
                
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 3 + 2;
                const distance = Math.random() * 200 + 100;
                
                const animation = heart.animate([
                    {
                        transform: 'translate(-50%, -50%) scale(1)',
                        opacity: 1
                    },
                    {
                        transform: `translate(calc(-50% + ${Math.cos(angle) * distance}px), calc(-50% + ${Math.sin(angle) * distance}px)) scale(0)`,
                        opacity: 0
                    }
                ], {
                    duration: 1000,
                    easing: 'ease-out',
                    delay: i * 20
                });
                
                animation.onfinish = () => heart.remove();
            }
        }

        // Music System
        function playMusic(pageNumber) {
            const musics = [
                null,
                document.getElementById('bgMusic1'),
                document.getElementById('bgMusic2'),
                document.getElementById('bgMusic2'),
                document.getElementById('bgMusic3'),
                document.getElementById('bgMusic4')
            ];
            
            const newMusic = musics[pageNumber];
            
            if (currentMusic && currentMusic !== newMusic) {
                fadeOut(currentMusic);
            }
            
            if (newMusic && newMusic !== currentMusic) {
                fadeIn(newMusic);
                currentMusic = newMusic;
                isMusicPlaying = true;
                document.getElementById('musicBtn').textContent = 'üéµ';
            }
        }

        function fadeOut(audio) {
            const fadeOutInterval = setInterval(() => {
                if (audio.volume > 0.05) {
                    audio.volume -= 0.05;
                } else {
                    audio.pause();
                    audio.volume = 0.3;
                    clearInterval(fadeOutInterval);
                }
            }, 50);
        }

        function fadeIn(audio) {
            audio.volume = 0;
            audio.play().catch(e => console.log('Audio play failed'));
            const fadeInInterval = setInterval(() => {
                if (audio.volume < 0.25) {
                    audio.volume += 0.05;
                } else {
                    audio.volume = 0.3;
                    clearInterval(fadeInInterval);
                }
            }, 50);
        }

        function toggleMusic() {
            if (isMusicPlaying && currentMusic) {
                currentMusic.pause();
                isMusicPlaying = false;
                document.getElementById('musicBtn').textContent = 'üîá';
            } else if (currentMusic) {
                currentMusic.play();
                isMusicPlaying = true;
                document.getElementById('musicBtn').textContent = 'üéµ';
            }
        }

        // Page Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            const pageNumber = parseInt(pageId.replace('page', ''));
            playMusic(pageNumber);
            
            if (pageId === 'page4') {
                setTimeout(() => {
                    setupQuestionForLongNames();
                    setupTeddyInteractions();
                }, 300);
            } else if (pageId === 'page5') {
                setTimeout(() => {
                    startGame();
                }, 500);
            }
        }

        // Start Journey
        function startJourney() {
            boyName = document.getElementById('boyName').value.trim() || 'My Love';
            girlName = document.getElementById('girlName').value.trim() || 'Beautiful';
            
            showPage('page2');
        }

        // Question for Long Names
        function setupQuestionForLongNames() {
            const questionEl = document.getElementById('question');
            questionEl.innerHTML = '';
            
            const totalLength = boyName.length + girlName.length;
            
            // Adjust font size based on total name length
            if (totalLength > 25) {
                questionEl.style.fontSize = 'clamp(1.3em, 3.5vw, 1.8em)';
            } else if (totalLength > 15) {
                questionEl.style.fontSize = 'clamp(1.5em, 4vw, 2.2em)';
            }
            
            // Create text with proper line breaks
            const questionText = `Will you be ${boyName}'s Valentine, ${girlName}? üíñ`;
            typeWriter(questionEl, questionText, 60);
        }

        function typeWriter(element, text, speed = 50) {
            let i = 0;
            element.textContent = '';
            element.style.borderRight = '3px solid #ff6b9d';
            
            function type() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    element.style.borderRight = 'none';
                }
            }
            type();
        }

        // Teddy Interactions
        function setupTeddyInteractions() {
            const noBtn = document.getElementById('noBtn');
            const yesBtn = document.getElementById('yesBtn');
            const teddyMouth = document.getElementById('teddyMouth');
            const mouthElement = document.getElementById('mouthElement');
            const teddyHeart = document.getElementById('teddyHeart');
            const leftArm = document.getElementById('leftArm');
            const rightArm = document.getElementById('rightArm');
            const leftEye = document.getElementById('leftEye');
            const rightEye = document.getElementById('rightEye');
            const leftCheek = document.getElementById('leftCheek');
            const rightCheek = document.getElementById('rightCheek');
            const teddyBear = document.getElementById('teddyBear2D');
            const teddyHead = document.querySelector('.teddy-head');
            const teddyNose = document.querySelector('.teddy-nose');
            const teddyBody = document.querySelector('.teddy-body');

            // Teddy hover effects
            if (teddyHead) {
                teddyHead.addEventListener('mouseenter', () => {
                    leftCheek.classList.add('active');
                    rightCheek.classList.add('active');
                    teddyBear.classList.add('shy');
                });
                
                teddyHead.addEventListener('mouseleave', () => {
                    if (!yesBtn.matches(':hover')) {
                        leftCheek.classList.remove('active');
                        rightCheek.classList.remove('active');
                        teddyBear.classList.remove('shy');
                    }
                });
            }

            // Yes button
            yesBtn.addEventListener('mouseenter', () => {
                mouthElement.className = 'mouth-happy';
                teddyHeart.classList.add('show');
                leftCheek.classList.add('active');
                rightCheek.classList.add('active');
                
                leftArm.style.transform = 'rotate(-60deg) translateX(-10px) translateY(-10px)';
                rightArm.style.transform = 'rotate(60deg) translateX(10px) translateY(-10px)';
                
                teddyBear.classList.remove('nervous', 'jealous');
                teddyBear.style.animation = 'float 0.8s ease-in-out infinite';
            });

            yesBtn.addEventListener('mouseleave', () => {
                resetTeddyExpression();
            });

            // No button
            noBtn.addEventListener('mouseenter', () => {
                mouthElement.className = 'mouth-sad';
                teddyHeart.classList.remove('show');
                leftCheek.classList.remove('active');
                rightCheek.classList.remove('active');
                
                leftEye.classList.add('narrow');
                rightEye.classList.add('narrow');
                
                teddyBear.classList.remove('nervous');
                teddyBear.classList.add('jealous');
                
                moveNoButton();
            });

            noBtn.addEventListener('mouseleave', () => {
                resetTeddyExpression();
            });

            noBtn.addEventListener('click', (e) => {
                e.preventDefault();
                moveNoButton();
            });

            // Mobile touch events
            noBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                moveNoButton();
            });

            // Mouse following eyes
            const handleMouseMove = (e) => {
                const teddyRect = teddyBear.getBoundingClientRect();
                const teddyCenterX = teddyRect.left + teddyRect.width / 2;
                const teddyCenterY = teddyRect.top + teddyRect.height / 2;
                
                const deltaX = e.clientX - teddyCenterX;
                const deltaY = e.clientY - teddyCenterY;
                
                const eyeMoveX = deltaX / 150;
                const eyeMoveY = deltaY / 150;
                
                const leftPupil = leftEye.querySelector('.eye-pupil');
                const rightPupil = rightEye.querySelector('.eye-pupil');
                
                if (leftPupil && rightPupil) {
                    leftPupil.style.transform = `translate(calc(-50% + ${eyeMoveX}px), calc(-50% + ${eyeMoveY}px))`;
                    rightPupil.style.transform = `translate(calc(-50% + ${eyeMoveX}px), calc(-50% + ${eyeMoveY}px))`;
                }
            };

            document.addEventListener('mousemove', handleMouseMove);
        }

        function moveNoButton() {
            const noBtn = document.getElementById('noBtn');
            const container = document.querySelector('#page4 .container');
            const containerRect = container.getBoundingClientRect();
            
            const maxX = containerRect.width - noBtn.offsetWidth - 20;
            const maxY = containerRect.height - noBtn.offsetHeight - 20;
            
            const randomX = Math.random() * maxX + 10;
            const randomY = Math.random() * maxY + 10;
            
            noBtn.style.position = 'absolute';
            noBtn.style.left = randomX + 'px';
            noBtn.style.top = randomY + 'px';
            
            // Vibration feedback
            if ('vibrate' in navigator) {
                navigator.vibrate(50);
            }
        }

        function resetTeddyExpression() {
            const mouthElement = document.getElementById('mouthElement');
            const teddyHeart = document.getElementById('teddyHeart');
            const leftArm = document.getElementById('leftArm');
            const rightArm = document.getElementById('rightArm');
            const leftEye = document.getElementById('leftEye');
            const rightEye = document.getElementById('rightEye');
            const leftCheek = document.getElementById('leftCheek');
            const rightCheek = document.getElementById('rightCheek');
            const teddyBear = document.getElementById('teddyBear2D');
            
            mouthElement.className = 'mouth-neutral';
            teddyHeart.classList.remove('show');
            leftCheek.classList.remove('active');
            rightCheek.classList.remove('active');
            
            leftArm.style.transform = 'rotate(-30deg)';
            rightArm.style.transform = 'rotate(30deg)';
            
            leftEye.classList.remove('narrow');
            rightEye.classList.remove('narrow');
            
            const leftPupil = leftEye.querySelector('.eye-pupil');
            const rightPupil = rightEye.querySelector('.eye-pupil');
            if (leftPupil) leftPupil.style.transform = 'translate(-50%, -50%)';
            if (rightPupil) rightPupil.style.transform = 'translate(-50%, -50%)';
            
            teddyBear.style.transform = '';
            teddyBear.classList.remove('jealous', 'shy');
            teddyBear.classList.add('nervous');
        }

        function acceptProposal() {
            const teddyBear = document.getElementById('teddyBear2D');
            
            // Create heart explosion animation
            createHeartExplosion();
            
            // Teddy happy dance
            teddyBear.style.animation = 'float 0.5s ease-in-out infinite';
            
            setTimeout(() => {
                showPage('page5');
            }, 1500);
        }

        // Game
        function startGame() {
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            
            // Adjust canvas size for mobile
            const isMobile = window.innerWidth < 768;
            if (isMobile) {
                canvas.width = Math.min(350, window.innerWidth * 0.9);
                canvas.height = 450;
            } else if (window.innerWidth < 1024) {
                canvas.width = 450;
                canvas.height = 550;
            }
            
            let timeLeft = 30;
            gameScore = 0;
            comboCount = 0;
            
            const hearts = [];
            const bearWidth = 80;
            const bearHeight = 80;
            let bearX = canvas.width / 2 - bearWidth / 2;

            const updateBearPosition = (clientX, rect) => {
                bearX = clientX - rect.left - bearWidth / 2;
                bearX = Math.max(0, Math.min(canvas.width - bearWidth, bearX));
            };

            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                updateBearPosition(e.clientX, rect);
            });

            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const touch = e.touches[0];
                updateBearPosition(touch.clientX, rect);
            });

            function createHeart(type = 'normal') {
                const speed = 2 + Math.random() * (timeLeft < 15 ? 5 : 3);
                hearts.push({
                    x: Math.random() * (canvas.width - 30),
                    y: -30,
                    speed: speed,
                    type: type,
                    size: type === 'golden' ? 25 : (type === 'broken' ? 20 : 20),
                    rotation: Math.random() * Math.PI * 2
                });
            }

            const heartInterval = setInterval(() => {
                const rand = Math.random();
                if (rand < 0.10) createHeart('golden');
                else if (rand < 0.18) createHeart('broken');
                else createHeart('normal');
                
                if (timeLeft < 15) createHeart();
            }, 400);

            const timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    clearInterval(heartInterval);
                    endGame();
                }
            }, 1000);

            function drawHeart(x, y, size, color) {
                ctx.save();
                ctx.translate(x + size/2, y + size/2);
                
                ctx.fillStyle = color;
                ctx.beginPath();
                const topCurveHeight = size * 0.3;
                ctx.moveTo(0, topCurveHeight);
                ctx.bezierCurveTo(0, 0, -size/2, 0, -size/2, topCurveHeight);
                ctx.bezierCurveTo(-size/2, (size + topCurveHeight)/2, 0, (size + topCurveHeight)/1.2, 0, size);
                ctx.bezierCurveTo(0, (size + topCurveHeight)/1.2, size/2, (size + topCurveHeight)/2, size/2, topCurveHeight);
                ctx.bezierCurveTo(size/2, 0, 0, 0, 0, topCurveHeight);
                ctx.fill();
                
                if(color === '#FFD700') {
                    ctx.strokeStyle = '#FFA500';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }
                
                ctx.restore();
            }

            function drawCuteBear(x, y) {
                ctx.save();
                
                // Body
                ctx.fillStyle = '#FFB6C1';
                ctx.strokeStyle = '#FF8FA3';
                ctx.lineWidth = 2;
                
                ctx.beginPath();
                ctx.ellipse(x + 40, y + 55, 25, 30, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                // Head
                ctx.beginPath();
                ctx.arc(x + 40, y + 30, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                // Ears
                ctx.beginPath();
                ctx.arc(x + 15, y + 15, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                ctx.beginPath();
                ctx.arc(x + 65, y + 15, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                // Inner ears
                ctx.fillStyle = '#FF6B9D';
                ctx.beginPath();
                ctx.arc(x + 15, y + 15, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x + 65, y + 15, 8, 0, Math.PI * 2);
                ctx.fill();
                
                // Eyes
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(x + 30, y + 28, 7, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x + 50, y + 28, 7, 0, Math.PI * 2);
                ctx.fill();
                
                // Pupils
                ctx.fillStyle = '#4A235A';
                ctx.beginPath();
                ctx.arc(x + 30, y + 28, 4, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x + 50, y + 28, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // Eye sparkles
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(x + 28, y + 26, 1.5, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x + 48, y + 26, 1.5, 0, Math.PI * 2);
                ctx.fill();
                
                // Nose
                ctx.fillStyle = '#FF6B9D';
                ctx.beginPath();
                ctx.ellipse(x + 40, y + 40, 7, 5, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Mouth
                ctx.strokeStyle = '#4A235A';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(x + 40, y + 45, 10, 0.2, Math.PI - 0.2);
                ctx.stroke();
                
                // Cheeks
                ctx.fillStyle = 'rgba(255, 107, 157, 0.3)';
                ctx.beginPath();
                ctx.arc(x + 20, y + 40, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(x + 60, y + 40, 8, 0, Math.PI * 2);
                ctx.fill();
                
                // Arms
                ctx.fillStyle = '#FFB6C1';
                ctx.strokeStyle = '#FF8FA3';
                ctx.lineWidth = 2;
                
                ctx.beginPath();
                ctx.ellipse(x + 10, y + 60, 12, 20, Math.PI/4, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                ctx.beginPath();
                ctx.ellipse(x + 70, y + 60, 12, 20, -Math.PI/4, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                ctx.restore();
            }

            function gameLoop() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw background gradient
                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, 'rgba(255, 107, 157, 0.1)');
                gradient.addColorStop(1, 'rgba(26, 26, 46, 0.1)');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Update and draw hearts
                for(let i = hearts.length - 1; i >= 0; i--) {
                    hearts[i].y += hearts[i].speed;
                    
                    const color = hearts[i].type === 'golden' ? '#FFD700' : 
                                 hearts[i].type === 'broken' ? '#666' : '#ff69b4';
                    
                    drawHeart(hearts[i].x, hearts[i].y, hearts[i].size, color);

                    // Check collision
                    if(hearts[i].y > canvas.height - bearHeight - 30 && 
                       hearts[i].y < canvas.height - bearHeight + 20 &&
                       hearts[i].x > bearX && 
                       hearts[i].x < bearX + bearWidth) {
                        
                        const currentTime = Date.now();
                        if(currentTime - lastCatchTime < 1000) {
                            comboCount++;
                        } else {
                            comboCount = 1;
                        }
                        lastCatchTime = currentTime;
                        
                        if(hearts[i].type === 'golden') {
                            gameScore += 3;
                        } else if(hearts[i].type === 'broken') {
                            gameScore = Math.max(0, gameScore - 1);
                        } else {
                            gameScore++;
                        }
                        
                        // Vibration feedback
                        if ('vibrate' in navigator) {
                            navigator.vibrate(30);
                        }
                        
                        gameScore = Math.max(0, gameScore);
                        document.getElementById('score').textContent = gameScore;
                        document.getElementById('combo').textContent = comboCount;
                        hearts.splice(i, 1);
                    } else if(hearts[i].y > canvas.height) {
                        hearts.splice(i, 1);
                        comboCount = 0;
                        document.getElementById('combo').textContent = comboCount;
                    }
                }

                drawCuteBear(bearX, canvas.height - bearHeight);

                if(timeLeft > 0) {
                    requestAnimationFrame(gameLoop);
                }
            }

            gameLoop();
        }

        function endGame() {
            const percentage = Math.min(100, Math.max(10, gameScore * 2));
            document.getElementById('lovePercentage').textContent = `${Math.round(percentage)}% Love! üíï`;
            
            const today = new Date();
            document.getElementById('certDate').textContent = today.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            document.getElementById('certGirl').textContent = girlName;
            document.getElementById('certScore').textContent = gameScore;
            document.getElementById('certPercent').textContent = Math.round(percentage);
            document.getElementById('certBoy').textContent = boyName;
            
            showPage('page6');
            
            // Create celebration fireworks
            setTimeout(createHeartExplosion, 500);
            setTimeout(createHeartExplosion, 1000);
            setTimeout(createHeartExplosion, 1500);
        }

        function shareCertificate() {
            const text = `üíï ${girlName} and ${boyName}'s Love Certificate üíï\n` +
                        `Love Percentage: ${Math.round(gameScore * 2)}%\n` +
                        `Hearts Captured: ${gameScore}\n\n` +
                        `Will you be my Valentine? üíñ`;
            
            if(navigator.share) {
                navigator.share({
                    title: 'üíï Our Love Certificate',
                    text: text,
                    url: window.location.href
                }).catch(err => console.log('Share cancelled'));
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Certificate copied to clipboard! üìã');
                });
            }
        }

        // Prevent zoom on mobile
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        // Prevent double tap zoom
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Handle orientation changes
        window.addEventListener('orientationchange', function() {
            setTimeout(() => {
                window.location.reload();
            }, 100);
        });
    </script>
</body>
</html>